@using Microsoft.AspNetCore.Identity
@using LabProject.Areas.Identity.Data

@inject SignInManager<ApplicationUser> SignInManager
@inject UserManager<ApplicationUser> UserManager

@{
    Layout = ViewBag.Layout;
    ViewData["Title"] = "Dashboard";
    var exp = ViewBag.Expenses;


}

<div class="container w-100 d-flex justify-content-between align-items-center flex-wrap">
    <div class="d-flex align-items-center mb-2">
        <span class="fs-2">Welcome to the</span>
        <h1 class="m-0 ms-2 fw-semibold fs-2">@ViewData["Title"]</h1>
    </div>
    @* <h2>@Html.Raw(ViewBag.Message) 👋🏼</h2> *@

</div>


<div class="container">
    <div class="row">
        <div class="col-md-3">
            <div class="card">
                <div class="card-body text-center">
                    <h5 class="card-title">Account Balance</h5>
                    <p class="card-text count" ><span class="h2">@ViewData["Total"]</span></p>
                    <i class='bx bxs-bank fs-1'></i>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="card">
                <div class="card-body text-center">
                    <h5 class="card-title">Expenses This Month</h5>
                    <p class="card-text count"><span class="h2 text-danger">@ViewData["Expenses"]</span></p>
                    <i class='bx bx-down-arrow-circle fs-1'></i>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="card">
                <div class="card-body text-center">
                    <h5 class="card-title">Income This Month</h5>
                    <p class="card-text count"><span class="h2 text-success">@ViewData["Income"]</span></p>
                    <i class='bx bx-up-arrow-circle fs-1'></i>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="card">
                <div class="card-body text-center">
                    <h5 class="card-title">Remaining to Goal</h5>
                    <p class="card-text"><span class="h2">$323.42</span></p>
                    <i class="bx bx-trophy fs-1"></i>
                </div>
            </div>
        </div>
    </div>

    <div class="row mt-4">
        <div class="col-md-6">
            <div class="card">
                <div class="card-header">
                    <h5 class="card-title m-0 me-2">Expenses by Category (This Month)</h5>

                </div>
                <div class="card-body">
                    <canvas id="expensesByCategoryChart"></canvas>
                </div>
            </div>
        </div>
        <div class="col-md-6">
            <div class="card">
                <div class="card-header">
                    <h5 class="card-title m-0 me-2">Income vs. Expenses (Last 3 Months)</h5>

                </div>
                <div class="card-body">
                    <canvas id="incomeVsExpensesChart"></canvas>
                </div>
            </div>
        </div>
    </div>
    @if (!User.IsInRole("UserPremium"))
    {
        <div class="row mt-4">
            <div class="col-md-12">
            <div class="card">
                <div class="card-header">
                    <h3 class="card-title m-0 me-2">Wanna see more?</h3>

                </div>
                <div class="card-body">
                        <p>Unlock the full potential of your experience with our Premium subscription! Gain exclusive access to detailed transaction summaries and a suite of advanced features designed to enhance your journey. Don’t miss out – upgrade today and take control of your data like never before!</p>
                        <button class="btn btn-primary" onclick="location.href='@Url.Action("AssignPremiumRole", "Dashboard")'">Buy Premium </button>
                
                </div>
        </div>
        </div>
        </div>
    }
    @if (User.IsInRole("UserPremium")){
        <div class="row mt-4">
            <div class="col-md-12">
                <div class="card">
                    <div class="card-header">
                        <h5 class="card-title m-0 me-2">Recent Transactions</h5>

                    </div>
                    <div class="card-body">
                        <table class="table table-striped">
                            <thead>
                                <tr>
                                    <th>Date</th>
                                    <th>Category</th>
                                    <th>Description</th>
                                    <th>Amount</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>2024-12-09</td>
                                    <td>Food</td>
                                    <td>Lunch at Restaurant</td>
                                    <td>$25.00</td>
                                </tr>
                                <tr>
                                    <td>2024-12-09</td>
                                    <td>Transport</td>
                                    <td>Taxi fare</td>
                                    <td>$15.00</td>
                                </tr>
                                <tr>
                                    <td>2024-12-09</td>
                                    <td>Entertainment</td>
                                    <td>Movie Ticket</td>
                                    <td>$12.00</td>
                                </tr>
                                <tr>
                                    <td>2024-12-09</td>
                                    <td>Food</td>
                                    <td>Groceries</td>
                                    <td>$40.00</td>
                                </tr>
                                <tr>
                                    <td>2024-12-09</td>
                                    <td>Utilities</td>
                                    <td>Electricity Bill</td>
                                    <td>$60.00</td>
                                </tr>

                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
}
    
</div>


<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js" integrity="sha384-geWFuzAMKJ01jxBOSeLeWGK9Qp0hW81l+C94JQhUkM/h4GPgy2QPk9wF7YVHUkXKYl" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
